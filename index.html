<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shakey Worm of Doom</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      overflow: hidden;
      font-family: Comic Sans MS, cursive;
    }
    canvas {
      display: block;
    }
    #warning {
      position: absolute;
      top: 20px;
      left: 20px;
      background: yellow;
      color: red;
      font-size: 24px;
      padding: 10px;
      border: 4px solid red;
      animation: blink 1s infinite;
      z-index: 10;
    }
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
  </style>
</head>
<body>
  <div id="warning">FLASH WARNING! SHAKE TO UNLEASH THE FRENZY!</div>
  <canvas id="canvas"></canvas>
  <audio id="blast" src="https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3"></audio>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const segments = [];
    const segCount = 25;
    let mouseX = canvas.width/2;
    let mouseY = canvas.height/2;
    let shakeThreshold = 30;
    let lastPos = { x: mouseX, y: mouseY };
    let blastTriggered = false;
    let colorHue = 0;
    const audio = document.getElementById('blast');

    for (let i = 0; i < segCount; i++) {
      segments.push({ x: mouseX, y: mouseY });
    }

    function lerp(a, b, t) {
      return a + (b - a) * t;
    }

    function drawWorm() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      ctx.moveTo(segments[0].x, segments[0].y);

      for (let i = 1; i < segCount; i++) {
        segments[i].x = lerp(segments[i].x, segments[i-1].x, 0.4);
        segments[i].y = lerp(segments[i].y, segments[i-1].y, 0.4);
        ctx.lineTo(segments[i].x, segments[i].y);
      }

      ctx.strokeStyle = `hsl(${colorHue}, 100%, 50%)`;
      ctx.lineWidth = 18;
      ctx.lineCap = 'round';
      ctx.stroke();

      if (blastTriggered) {
        colorHue += 30;
        ctx.fillStyle = `hsla(${Math.random()*360}, 100%, 50%, 0.4)`;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }
    }

    function update() {
      const dx = mouseX - lastPos.x;
      const dy = mouseY - lastPos.y;
      const dist = Math.sqrt(dx*dx + dy*dy);

      if (dist > shakeThreshold && !blastTriggered) {
        blastTriggered = true;
        audio.play();
      }

      segments[0].x = mouseX;
      segments[0].y = mouseY;
      lastPos = { x: mouseX, y: mouseY };

      drawWorm();
      requestAnimationFrame(update);
    }

    document.addEventListener('mousemove', e => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });

    update();
  </script>
</body>
</html>
